---
title: "Mixed models - alex vs autism on physiology, subjective and their relationship - just NT"
output: html_document
date: "2025-12-10"
---

##############
# now just NT

SCR
these are not affected by 606

```{r}
dta_4_lmms_sel_1_w_impt_nt<- dta_4_lmms_sel_1_w_impt%>%subset(nt_asd!= "ASD")%>%
  mutate(tas_imptd_z = scale(tas_imptd)[,1],
         aq_imptd_z = scale(aq_imptd)[,1],
         arousal_0_1_z = scale(arousal_0_1)[,1]
         )

mod_lmer$cda_phasmax_0_nt <- lmer(log1p(bio_cda_iscr_no_outl_imptd+.109) ~ 1+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

mod_lmer$cda_phasmax_0.1_nt <- lmer(log1p(bio_cda_iscr_no_outl_imptd+.109) ~ 1+arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

anova(mod_lmer$cda_phasmax_0.1_nt )
```

```{r}

cor.test(dta_4_lmms_sel_1_w_impt_nt$tas_imptd_z, dta_4_lmms_sel_1_w_impt_nt$aq_imptd_z)

mod_lmer$cda_phasmax_5 <- lmer(log1p(bio_cda_iscr_no_outl_imptd+.109) ~ 1+tas_imptd_z*arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$cda_phasmax_5 , type = 3)
anova(mod_lmer$cda_phasmax_5 , type = 3)
summary(mod_lmer$cda_phasmax_5 )

#alexithymia effects
#and arousal effects
# replicates full group analysis
```
Type III Analysis of Variance Table with Satterthwaite's method
                           Sum Sq Mean Sq NumDF  DenDF F value   Pr(>F)   
tas_imptd_z               2.70375 2.70375     1   66.0  8.9316 0.003933 **
arousal_0_1_z             1.57651 1.57651     1  296.9  5.2078 0.023193 * 
tas_imptd_z:arousal_0_1_z 0.06475 0.06475     1 3236.1  0.2139 0.643758   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1]

```{r}
mod_lmer$cda_phasmax_6 <- lmer(log1p(bio_cda_iscr_no_outl_imptd+.109) ~ 1+aq_imptd_z*arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                    data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$cda_phasmax_2 , type = 3)
anova(mod_lmer$cda_phasmax_2 , type = 3)
summary(mod_lmer$cda_phasmax_2 )
# aq is also significant in addition to arousal


```


```{r}
anova(mod_lmer$cda_phasmax_0_nt, mod_lmer$cda_phasmax_0.1_nt, mod_lmer$cda_phasmax_5, mod_lmer$cda_phasmax_6)
#TAS model is the best
```
Data: dta_4_lmms_sel_1_w_impt_nt
Models:
mod_lmer$cda_phasmax_0_nt: log1p(bio_cda_iscr_no_outl_imptd + 0.109) ~ 1 + (1 | stimiaps2) + (1 | ssid)
mod_lmer$cda_phasmax_0.1_nt: log1p(bio_cda_iscr_no_outl_imptd + 0.109) ~ 1 + arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$cda_phasmax_5: log1p(bio_cda_iscr_no_outl_imptd + 0.109) ~ 1 + tas_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$cda_phasmax_6: log1p(bio_cda_iscr_no_outl_imptd + 0.109) ~ 1 + aq_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
                            npar    AIC    BIC  logLik -2*log(L)  Chisq Df Pr(>Chisq)  
mod_lmer$cda_phasmax_0_nt      4 5635.8 5660.2 -2813.9    5627.8                       
mod_lmer$cda_phasmax_0.1_nt    5 5633.2 5663.6 -2811.6    5623.2 4.6622  1    0.03083 *
mod_lmer$cda_phasmax_5         7 5628.6 5671.2 -2807.3    5614.6 8.6135  2    0.01348 *
mod_lmer$cda_phasmax_6         7 5632.5 5675.1 -2809.2    5618.5 0.0000  0             
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
HR

```{r}
# just NT
mod_lmer$hr_dif_0_nt <- lmer(bio_mean_hr_dif_no_outl_imptd ~ 1+
                                   (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

mod_lmer$hr_dif_0_ar_nt <- lmer(bio_mean_hr_dif_no_outl_imptd ~ 1+
                                  arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)


mod_lmer$hr_dif_5 <- lmer(bio_mean_hr_dif_no_outl_imptd ~ 1+tas_imptd_z*arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$hr_dif_5 , type = 3)
anova(mod_lmer$hr_dif_5 , type = 3)
summary(mod_lmer$hr_dif_5 )

```
Analysis of Deviance Table (Type III Wald chisquare tests)

Response: bio_mean_hr_dif_no_outl_imptd
                             Chisq Df           Pr(>Chisq)    
(Intercept)               188.6027  1 < 0.0000000000000002 ***
tas_imptd_z                 0.6566  1              0.41777    
arousal_0_1_z               2.8185  1              0.09318 .  
tas_imptd_z:arousal_0_1_z   4.4394  1              0.03512 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# tas effects int
# 


```{r}
mod_lmer$hr_dif_6 <- lmer(bio_mean_hr_dif_no_outl_imptd ~ 1+aq_imptd_z*arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$hr_dif_6 , type = 3)
anova(mod_lmer$hr_dif_6 , type = 3)
summary(mod_lmer$hr_dif_6 )

```
Analysis of Deviance Table (Type III Wald chisquare tests)

Response: bio_mean_hr_dif_no_outl_imptd
                            Chisq Df          Pr(>Chisq)    
(Intercept)              191.4945  1 <0.0000000000000002 ***
aq_imptd_z                 1.6154  1              0.2037    
arousal_0_1_z              2.3483  1              0.1254    
aq_imptd_z:arousal_0_1_z   0.5771  1              0.4474    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


# no effects of aq or arousal
# hr_dif_0_nt
```{r}
anova(mod_lmer$hr_dif_0_nt, mod_lmer$hr_dif_0_ar_nt, mod_lmer$hr_dif_5, mod_lmer$hr_dif_6 )
```
Data: dta_4_lmms_sel_1_w_impt_nt
Models:
mod_lmer$hr_dif_0_nt: bio_mean_hr_dif_no_outl_imptd ~ 1 + (1 | stimiaps2) + (1 | ssid)
mod_lmer$hr_dif_0_ar_nt: bio_mean_hr_dif_no_outl_imptd ~ 1 + arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$hr_dif_5: bio_mean_hr_dif_no_outl_imptd ~ 1 + tas_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$hr_dif_6: bio_mean_hr_dif_no_outl_imptd ~ 1 + aq_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
                        npar   AIC   BIC  logLik -2*log(L)  Chisq Df Pr(>Chisq)  
mod_lmer$hr_dif_0_nt       4 18818 18843 -9405.2     18810                       
mod_lmer$hr_dif_0_ar_nt    5 18818 18849 -9404.2     18808 2.1402  1    0.14348  
mod_lmer$hr_dif_5          7 18817 18860 -9401.6     18803 5.1027  2    0.07798 .
mod_lmer$hr_dif_6          7 18820 18863 -9403.1     18806 0.0000  0             
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

pupil
```{r}
# just NT

mod_lmer$pup_0_nt <- lmer(pup_bascor_no_outl_imptd ~ 1+ 
                            # (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

mod_lmer$pup_0_ar_nt <- lmer(pup_bascor_no_outl_imptd ~ 1+arousal_0_1_z+ 
                               # (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$pup_0_nt , type = 3)
anova(mod_lmer$pup_0_nt , type = 3)
summary(mod_lmer$pup_0_nt )

mod_lmer$pup_5 <- lmer(pup_bascor_no_outl_imptd ~ 1+tas_imptd_z*arousal_0_1_z+ 
                         # (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$pup_5 , type = 3)
anova(mod_lmer$pup_5 , type = 3)
summary(mod_lmer$pup_5 )

# effects of arousal only ;(differs from the other z tas)
# 


```

Analysis of Deviance Table (Type III Wald chisquare tests)

Response: pup_bascor_no_outl_imptd
                            Chisq Df     Pr(>Chisq)    
(Intercept)               12.5790  1      0.0003901 ***
tas_imptd_z                0.0103  1      0.9190687    
arousal_0_1_z             33.0676  1 0.000000008901 ***
tas_imptd_z:arousal_0_1_z  1.9313  1      0.1646120    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```{r}
mod_lmer$pup_6 <- lmer(pup_bascor_no_outl_imptd ~ 1+aq_imptd_z*arousal_0_1_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

car::Anova(mod_lmer$pup_6 , type = 3)
anova(mod_lmer$pup_6 , type = 3)
summary(mod_lmer$pup_6 )

# similar effect of arousal only

```

Analysis of Deviance Table (Type III Wald chisquare tests)

Response: pup_bascor_no_outl_imptd
                           Chisq Df     Pr(>Chisq)    
(Intercept)              12.5930  1      0.0003872 ***
aq_imptd_z                0.3892  1      0.5326989    
arousal_0_1_z            34.4124  1 0.000000004459 ***
aq_imptd_z:arousal_0_1_z  2.1065  1      0.1466705    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```{r}
anova(mod_lmer$pup_0_nt,mod_lmer$pup_0_ar_nt, mod_lmer$pup_5, mod_lmer$pup_6)
# most models under perform

```
Data: dta_4_lmms_sel_1_w_impt_nt
Models:
mod_lmer$pup_0_nt: pup_bascor_no_outl_imptd ~ 1 + (1 | stimiaps2) + (1 | ssid)
mod_lmer$pup_0_ar_nt: pup_bascor_no_outl_imptd ~ 1 + arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$pup_5: pup_bascor_no_outl_imptd ~ 1 + tas_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
mod_lmer$pup_6: pup_bascor_no_outl_imptd ~ 1 + aq_imptd_z * arousal_0_1_z + (1 | stimiaps2) + (1 | ssid)
                     npar   AIC   BIC  logLik -2*log(L)   Chisq Df     Pr(>Chisq)    
mod_lmer$pup_0_nt       4 12164 12188 -6078.0     12156                              
mod_lmer$pup_0_ar_nt    5 12132 12162 -6061.0     12122 33.9669  1 0.000000005606 ***
mod_lmer$pup_5          7 12134 12177 -6060.0     12120  1.9681  2         0.3738    
mod_lmer$pup_6          7 12133 12176 -6059.7     12119  0.5424  0                   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

```{r}

dta_4_lmms_sel_1_w_impt_nt$pup_bascor_no_outl_imptd_z<- scale(dta_4_lmms_sel_1_w_impt_nt$pup_bascor_no_outl_imptd)[,1]




mod_lmer$hr_from_pup_nt <- lmer( bio_mean_hr_dif_no_outl_imptd~ 1+pup_bascor_no_outl_imptd_z*tas_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$hr_from_pup_nt , type = 3)


```
Type III Analysis of Variance Table with Satterthwaite's method
                                       Sum Sq Mean Sq NumDF   DenDF F value  Pr(>F)  
pup_bascor_no_outl_imptd_z             62.750  62.750     1  821.86  3.6207 0.05742 .
tas_imptd_z                            12.040  12.040     1   65.76  0.6947 0.40759  
pup_bascor_no_outl_imptd_z:tas_imptd_z 77.824  77.824     1 3053.81  4.4904 0.03417 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

```{r}

mod_lmer$hr_from_pup_nt_aq <- lmer( bio_mean_hr_dif_no_outl_imptd~ 1+pup_bascor_no_outl_imptd_z*aq_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$hr_from_pup_nt_aq , type = 3)


```
Type III Analysis of Variance Table with Satterthwaite's method
                                      Sum Sq Mean Sq NumDF   DenDF F value  Pr(>F)  
pup_bascor_no_outl_imptd_z            58.294  58.294     1  819.39  3.3588 0.06721 .
aq_imptd_z                            28.936  28.936     1   66.31  1.6673 0.20111  
pup_bascor_no_outl_imptd_z:aq_imptd_z 17.570  17.570     1 3016.45  1.0123 0.31442  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1


```{r}
dta_4_lmms_sel_1_w_impt_nt$bio_cda_iscr_no_outl_imptd_log_z<- scale(log1p(dta_4_lmms_sel_1_w_impt_nt$bio_cda_iscr_no_outl_imptd+.01))

mod_lmer$hr_from_scr_nt <- lmer( bio_mean_hr_dif_no_outl_imptd~ 1+bio_cda_iscr_no_outl_imptd_log_z*tas_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$hr_from_scr_nt , type = 3)

```
Type III Analysis of Variance Table with Satterthwaite's method
                                              Sum Sq Mean Sq NumDF   DenDF F value   Pr(>F)   
bio_cda_iscr_no_outl_imptd_log_z             143.282 143.282     1 2584.31  8.2323 0.004149 **
tas_imptd_z                                   29.315  29.315     1   66.26  1.6843 0.198854   
bio_cda_iscr_no_outl_imptd_log_z:tas_imptd_z  13.089  13.089     1 2818.84  0.7520 0.385913   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```{r}

mod_lmer$hr_from_scr_nt_aq <- lmer( bio_mean_hr_dif_no_outl_imptd~ 1+bio_cda_iscr_no_outl_imptd_log_z*aq_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$hr_from_scr_nt_aq , type = 3)

```
Type III Analysis of Variance Table with Satterthwaite's method
                                            Sum Sq Mean Sq NumDF   DenDF F value  Pr(>F)  
bio_cda_iscr_no_outl_imptd_log_z            99.801  99.801     1 2564.22  5.7405 0.01665 *
aq_imptd_z                                  42.627  42.627     1   65.32  2.4519 0.12221  
bio_cda_iscr_no_outl_imptd_log_z:aq_imptd_z 33.307  33.307     1 2772.91  1.9158 0.16643  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

```{r}
dta_4_lmms_sel_1_w_impt_nt$bio_cda_iscr_no_outl_imptd_log1p<- (log1p(dta_4_lmms_sel_1_w_impt_nt$bio_cda_iscr_no_outl_imptd+.01))

mod_lmer$scr_from_pup_nt <- lmer( bio_cda_iscr_no_outl_imptd_log1p~ 1+pup_bascor_no_outl_imptd_z*tas_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$scr_from_pup_nt , type = 3)
```
Type III Analysis of Variance Table with Satterthwaite's method
                                        Sum Sq Mean Sq NumDF  DenDF F value   Pr(>F)   
pup_bascor_no_outl_imptd_z             0.01363 0.01363     1  403.4  0.0420 0.837713   
tas_imptd_z                            2.83141 2.83141     1   66.0  8.7289 0.004338 **
pup_bascor_no_outl_imptd_z:tas_imptd_z 0.00691 0.00691     1 3240.3  0.0213 0.883960   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
```{r}

mod_lmer$scr_from_pup_nt_aq <- lmer( bio_cda_iscr_no_outl_imptd_log1p~ 1+pup_bascor_no_outl_imptd_z*aq_imptd_z+ (1 | stimiaps2)  + 
                                 (1 | ssid), REML = FALSE,
                      data = dta_4_lmms_sel_1_w_impt_nt)

# car::Anova(mod_lmer$cda_phasmax_from_hr_0 , type = 3)
anova(mod_lmer$scr_from_pup_nt_aq , type = 3)
```

```{r}


# okay can we look at only NT
cor.test(dta_cor$tas_imptd, dta_cor$aq_imptd)
 dta_cor$tas_imptd_z<- scale(dta_cor$tas_imptd)
 dta_cor$aq_imptd_z<- scale(dta_cor$aq_imptd)


dta_cor %>%
  pivot_longer(
    cols = starts_with("r2z"),
    names_to = "pair",
    values_to = "rho"
  ) %>%
 subset(nt_asd != "ASD")%>%
  ggplot(aes(x = tas_imptd_z_asid, y = rho)) +   # or `tas` if you prefer
  geom_point(aes(colour = nt_asd)) +
  geom_smooth(method = "lm", se = FALSE) +
 
  facet_wrap(~ pair) +
   ggpubr::stat_cor()+
  theme_minimal()+
  geom_text(aes(label = ssid))


dta_cor %>%
  pivot_longer(
    cols = starts_with("r2z"),
    names_to = "pair",
    values_to = "rho"
  ) %>%
  subset(nt_asd != "ASD")%>%
  ggplot(aes(x = aq_imptd_z_asid, y = rho)) +   # or `tas` if you prefer
   geom_point(aes(colour = nt_asd)) +
  geom_smooth(method = "lm", se = FALSE) +
 
  facet_wrap(~ pair) +
   ggpubr::stat_cor()+
  theme_minimal()+
  geom_text(aes(label = ssid))


dta_cor %>%
  pivot_longer(
    cols = starts_with("r2z"),
    names_to = "pair",
    values_to = "rho"
  ) %>%
  subset(nt_asd != "ASD")%>%
  group_by(ssid)%>%
  mutate(rho_abs = abs(rho))%>%
  summarise_if(is.numeric, mean,na.rm = T)%>%
  ggplot(aes(aq, rho_abs))+
            geom_smooth(method = "lm", se = FALSE) +
            ggpubr::stat_cor()+
  theme_minimal()+
  geom_text(aes(label = ssid))


dta_cor %>%
  pivot_longer(
    cols = starts_with("r2z"),
    names_to = "pair",
    values_to = "rho") %>%
  subset(nt_asd != "ASD")%>%
  group_by(ssid)%>%
  mutate(rho_abs = (rho^2))%>%
  summarise_if(is.numeric, mean,na.rm = T)%>%
  ggplot(aes(tas,log1p(rho_abs+.001)))+
            geom_smooth(method = "lm", se = FALSE) +
            ggpubr::stat_cor()+
  theme_minimal()+
  geom_text(aes(label = ssid))
           

```